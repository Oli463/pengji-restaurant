<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>å½­è®°é¥­åº— Â· ç‚¹é¤åŸå‹</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans",sans-serif}
body{background:#fafafa;color:#333}
header{padding:16px;background:#d62828;color:#fff;text-align:center;font-weight:600;font-size:1.25rem;position:sticky;top:0}
nav{position:fixed;bottom:0;left:0;right:0;height:56px;background:#fff;border-top:1px solid #ddd;display:flex}
nav button{flex:1;border:none;background:none;font-size:.9rem;color:#666}
nav button.active{color:#d62828;font-weight:600}
main{padding:72px 16px 80px 16px;max-width:600px;margin:auto}
.page{display:none}.page.active{display:block}
.dish{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding:8px;border-radius:8px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}
.dish h4{font-size:1rem;margin-bottom:4px}.dish span{font-size:.85rem;color:#d62828;font-weight:600}
.add-btn{padding:4px 8px;border:1px solid #d62828;background:#fff;color:#d62828;border-radius:4px;font-size:.85rem;cursor:pointer}
#cartBtn{position:fixed;bottom:70px;right:16px;padding:10px 16px;background:#d62828;color:#fff;border:none;border-radius:24px;font-size:.9rem;display:none}
table{width:100%;border-collapse:collapse;margin:16px 0}
th,td{border-bottom:1px solid #e0e0e0;padding:8px;text-align:left;font-size:.9rem}tfoot td{font-weight:600}
.pay-btn{width:100%;padding:12px 0;background:#d62828;color:#fff;font-size:1rem;border:none;border-radius:6px;cursor:pointer;margin-top:12px}
.notice{background:#fff5e6;border-left:4px solid #ffa502;padding:12px;font-size:.9rem;margin-top:16px}
</style>
</head>
<body>
<header id="headerTitle">å½­è®°é¥­åº—</header>
<main>
  <!-- é¦–é¡µ -->
  <section id="homePage" class="page active">
    <h2 style="margin-bottom:12px;">ğŸ”¥ ä»Šæ—¥æ‹›ç‰Œ</h2>
    <div class="dish"><div><h4>ç§æˆ¿é»„ç„–çŒªè„šé¥­</h4><span>20,000 UGX</span></div><button class="add-btn" data-id="0">åŠ å…¥</button></div>
    <div class="dish"><div><h4>ç²¾ç‚–é»„ç„–é¸¡ç±³é¥­</h4><span>25,000 UGX</span></div><button class="add-btn" data-id="1">åŠ å…¥</button></div>
    <div class="dish"><div><h4>ç§˜åˆ¶é»„ç„–æ’éª¨é¥­</h4><span>28,000 UGX</span></div><button class="add-btn" data-id="2">åŠ å…¥</button></div>
  </section>

  <!-- èœå•é¡µ -->
  <section id="menuPage" class="page">
    <h2 style="margin-bottom:12px;">å…¨éƒ¨èœå“</h2>
    <div id="menuList"></div>
  </section>

  <!-- è´­ç‰©è½¦ -->
  <section id="cartPage" class="page">
    <h2 style="margin-bottom:12px;">è´­ç‰©è½¦</h2>
    <div id="cartTableWrap"></div>
    <button class="pay-btn" id="checkoutBtn" disabled>å»ç»“ç®—</button>
  </section>

  <!-- ç»“ç®— -->
  <section id="checkoutPage" class="page">
    <h2 style="margin-bottom:12px;">ç¡®è®¤è®¢å•</h2>
    <label>ç”µè¯<br><input id="phoneInput" type="tel" style="width:100%;padding:8px;margin:4px 0 12px 0"></label>
    <label>åœ°å€<br><input id="addrInput" type="text" style="width:100%;padding:8px;margin:4px 0 12px 0"></label>
    <div id="checkoutList"></div>
    <button class="pay-btn" id="submitOrderBtn">ç¡®è®¤ä¸‹å•</button>
  </section>

  <!-- æ”¯ä»˜æŒ‡å¼• -->
  <section id="payPage" class="page">
    <h2 style="margin-bottom:12px;">æ”¯ä»˜æŒ‡å¼•</h2>
    <p>è®¢å•é‡‘é¢ï¼š<strong id="payAmount">0 UGX</strong></p>
    <p>MoMo æ”¶æ¬¾å·ç ï¼š<strong>077Â 123Â 4567</strong></p>
    <div class="notice">å®‰å“ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è‡ªåŠ¨æ‹¨å·ï¼›iPhone å·²å¤åˆ¶æŒ‡ä»¤ï¼Œè¯·ç²˜è´´æ‹¨å·ã€‚</div>
    <button class="pay-btn" id="ussdBtn">*165*3*0771234567*0#</button>
  </section>
</main>

<button id="cartBtn">0 UGX â†’</button>

<nav>
  <button data-tab="home" class="active">é¦–é¡µ</button>
  <button data-tab="menu">èœå•</button>
  <button data-tab="cart">è´­ç‰©è½¦</button>
  <button data-tab="checkout">æˆ‘çš„</button>
</nav>

<script>
// èœå“æ•°æ®
const dishes=[
  {id:0 ,name:"ç§æˆ¿é»„ç„–çŒªè„šé¥­",  price:20000},
  {id:1 ,name:"ç²¾ç‚–é»„ç„–é¸¡ç±³é¥­",  price:25000},
  {id:2 ,name:"ç§˜åˆ¶é»„ç„–æ’éª¨é¥­",  price:28000},
  {id:3 ,name:"é¾™å£ç²‰ä¸",        price:4000 },
  {id:4 ,name:"çº¢è–¯ç²‰ä¸",        price:4000 },
  {id:5 ,name:"åœŸè±†ç²‰",          price:5000 },
  {id:6 ,name:"å¹´ç³•",            price:5000 },
  {id:7 ,name:"ç™½èœ",            price:2000 },
  {id:8 ,name:"æµ·å¸¦",            price:2000 },
  {id:9 ,name:"ç©ºå¿ƒèœ",          price:3000 },
  {id:10,name:"ä¸Šæµ·é’",          price:2000 }
];

const cart={};

// DOM
const menuList=document.getElementById("menuList");
const cartBtn=document.getElementById("cartBtn");
const cartTableWrap=document.getElementById("cartTableWrap");
const checkoutBtn=document.getElementById("checkoutBtn");
const checkoutList=document.getElementById("checkoutList");
const payAmount=document.getElementById("payAmount");
const ussdBtn=document.getElementById("ussdBtn");

// æ¸²æŸ“èœå•
function renderMenu(){
  menuList.innerHTML="";
  dishes.forEach(d=>{
    menuList.insertAdjacentHTML("beforeend",
    `<div class="dish">
       <div><h4>${d.name}</h4><span>${d.price.toLocaleString()} UGX</span></div>
       <button class="add-btn" data-id="${d.id}">åŠ å…¥</button>
     </div>`);
  });
}
renderMenu();

// æ·»åŠ è´­ç‰©è½¦
function addToCart(id){
  cart[id]=(cart[id]||0)+1;
  updateCartBtn();
}

// æ›´æ–°æ‚¬æµ®è´­ç‰©è½¦æŒ‰é’®
function updateCartBtn(){
  const total=Object.entries(cart)
              .reduce((s,[id,qty])=>s+qty*dishes[id].price,0);
  cartBtn.style.display=total? "block":"none";
  cartBtn.textContent=`${total.toLocaleString()} UGX â†’`;
}

// è´­ç‰©è½¦è¡¨
function renderCartTable(){
  let t=0,html=`<table><thead><tr><th>èœå“</th><th>æ•°é‡</th><th>é‡‘é¢</th></tr></thead><tbody>`;
  Object.entries(cart).forEach(([id,qty])=>{
    const p=dishes[id].price; t+=p*qty;
    html+=`<tr><td>${dishes[id].name}</td><td>${qty}</td><td>${(p*qty).toLocaleString()} UGX</td></tr>`;
  });
  html+=`</tbody><tfoot><tr><td colspan="2">åˆè®¡</td><td>${t.toLocaleString()} UGX</td></tr></tfoot></table>`;
  cartTableWrap.innerHTML=html;
  checkoutBtn.disabled=!t;
}

// ç»“ç®—æ¸…å•
function renderCheckout(){
  let t=0,html="<ul style='list-style:none'>";
  Object.entries(cart).forEach(([id,qty])=>{
    const p=dishes[id].price; t+=p*qty;
    html+=`<li>${dishes[id].name} Ã—${qty} â€“ ${(p*qty).toLocaleString()} UGX</li>`;
  });
  html+=`</ul><p style='margin-top:8px;font-weight:600'>æ€»è®¡ï¼š${t.toLocaleString()} UGX</p>`;
  checkoutList.innerHTML=html;
}

// é¡µé¢åˆ‡æ¢
const pages={home:"homePage",menu:"menuPage",cart:"cartPage",checkout:"checkoutPage",pay:"payPage"};
function show(tab){
  Object.values(pages).forEach(id=>document.getElementById(id).classList.remove("active"));
  document.getElementById(pages[tab]).classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.toggle("active",b.dataset.tab===tab));
  if(tab==="cart") renderCartTable();
  if(tab==="checkout") renderCheckout();
}

// äº‹ä»¶ç»‘å®š
menuList.addEventListener("click",e=>{
  if(e.target.classList.contains("add-btn")) addToCart(e.target.dataset.id);
});
cartBtn.onclick=()=>show("cart");
checkoutBtn.onclick=()=>show("checkout");
  /* === åº•éƒ¨å¯¼èˆªæŒ‰é’® === */
document.querySelectorAll('nav button').forEach(btn=>{
  btn.onclick = ()=> show(btn.dataset.tab);   // å…³é”®ç»‘å®š
});


// â˜…â˜… å†™å…¥è®¢å• + åŸæ”¯ä»˜é€»è¾‘
const submitOrderBtn=document.getElementById("submitOrderBtn");
submitOrderBtn.onclick=()=>{
  const total=Object.entries(cart).reduce((s,[id,qty])=>s+qty*dishes[id].price,0);

  const newOrder={
    id:Date.now(),
    customer:document.getElementById('phoneInput').value,
    address :document.getElementById('addrInput').value,
    items   :Object.entries(cart).map(([id,qty])=>({name:dishes[id].name,qty:+qty})),
    total,
    status:"æœªå¤„ç†"
  };
  const all=JSON.parse(localStorage.getItem('orders')||'[]');
  all.push(newOrder);
  localStorage.setItem('orders',JSON.stringify(all));

  payAmount.textContent=total.toLocaleString()+" UGX";
  ussdBtn.textContent=`*165*3*0771234567*${total}#`;
  navigator.clipboard.writeText(ussdBtn.textContent).catch(()=>{});
  show("pay");
};

// USSD æŒ‰é’®
ussdBtn.onclick=()=>window.location.href="tel:"+ussdBtn.textContent;
</script>
</body></html>
