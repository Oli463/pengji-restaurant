<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>彭记饭店 · 点餐原型</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans",sans-serif}
    body{background:#fafafa;color:#333}
    header{padding:16px;background:#d62828;color:#fff;text-align:center;font-weight:600;font-size:1.25rem;position:sticky;top:0}
    nav{position:fixed;bottom:0;left:0;right:0;height:56px;background:#fff;border-top:1px solid #ddd;display:flex}
    nav button{flex:1;border:none;background:none;font-size:.9rem;color:#666}
    nav button.active{color:#d62828;font-weight:600}
    main{padding:72px 16px 80px 16px;max-width:600px;margin:auto}
    .page{display:none}
    .page.active{display:block}
    .dish{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding:8px;border-radius:8px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.05)}
    .dish h4{font-size:1rem;margin-bottom:4px}
    .dish span{font-size:.85rem;color:#d62828;font-weight:600}
    .add-btn{padding:4px 8px;border:1px solid #d62828;background:#fff;color:#d62828;border-radius:4px;font-size:.85rem;cursor:pointer}
    #cartBtn{position:fixed;bottom:70px;right:16px;padding:10px 16px;background:#d62828;color:#fff;border:none;border-radius:24px;font-size:.9rem;display:none}
    table{width:100%;border-collapse:collapse;margin:16px 0}
    th,td{border-bottom:1px solid #e0e0e0;padding:8px;text-align:left;font-size:.9rem}
    tfoot td{font-weight:600}
    .pay-btn{width:100%;padding:12px 0;background:#d62828;color:#fff;font-size:1rem;border:none;border-radius:6px;cursor:pointer;margin-top:12px}
    .notice{background:#fff5e6;border-left:4px solid #ffa502;padding:12px;font-size:.9rem;margin-top:16px}
  </style>
</head>
<body>
  <header id="headerTitle">彭记饭店</header>
  <main>
    <!-- 首页 -->
    <section id="homePage" class="page active">
      <h2 style="margin-bottom:12px;">🔥 今日招牌</h2>
      <div class="dish"><div><h4>私房黄焖猪脚饭</h4><span>20,000 UGX</span></div><button class="add-btn" data-id="0">加入</button></div>
      <div class="dish"><div><h4>精炖黄焖鸡米饭</h4><span>25,000 UGX</span></div><button class="add-btn" data-id="1">加入</button></div>
      <div class="dish"><div><h4>秘制黄焖排骨饭</h4><span>28,000 UGX</span></div><button class="add-btn" data-id="2">加入</button></div>
    </section>

    <!-- 菜单页 -->
    <section id="menuPage" class="page">
      <h2 style="margin-bottom:12px;">全部菜品</h2>
      <!-- 菜品列表由 JS 渲染 -->
      <div id="menuList"></div>
    </section>

    <!-- 购物车页 -->
    <section id="cartPage" class="page">
      <h2 style="margin-bottom:12px;">购物车</h2>
      <div id="cartTableWrap"></div>
      <button class="pay-btn" id="checkoutBtn" disabled>去结算</button>
    </section>

    <!-- 结算页 -->
    <section id="checkoutPage" class="page">
      <h2 style="margin-bottom:12px;">确认订单</h2>
      <label>电话<br><input type="tel" id="phoneInput" value="0700-000-000" style="width:100%;padding:8px;margin:4px 0 12px 0"></label>
      <label>地址<br><input type="text" id="addrInput" value="Naguru Drive 12" style="width:100%;padding:8px;margin:4px 0 12px 0"></label>
      <div id="checkoutList"></div>
      <button class="pay-btn" id="submitOrderBtn">确认下单</button>
    </section>

    <!-- 支付指引页 -->
    <section id="payPage" class="page">
      <h2 style="margin-bottom:12px;">支付指引</h2>
      <p>订单金额：<strong id="payAmount">0 UGX</strong></p>
      <p>MoMo 收款号码：<strong>077&nbsp;123&nbsp;4567</strong></p>
      <div class="notice">
        安卓用户：点击下方按钮自动拨号<br>
        iPhone 用户：指令已复制，请打开电话粘贴拨打
      </div>
      <button class="pay-btn" id="ussdBtn">*165*3*0771234567*0#</button>
    </section>
  </main>

  <button id="cartBtn">0 UGX →</button>

  <nav>
    <button data-tab="home" class="active">首页</button>
    <button data-tab="menu">菜单</button>
    <button data-tab="cart">购物车</button>
    <button data-tab="checkout">我的</button>
  </nav>

<script>
// 菜品数据
const dishes=[
  {id:0,name:"私房黄焖猪脚饭",price:20000},
  {id:1,name:"精炖黄焖鸡米饭",price:25000},
  {id:2,name:"秘制黄焖排骨饭",price:28000},
  {id:3,name:"龙口粉丝",price:4000},
  {id:4,name:"红薯粉丝",price:4000},
  {id:5,name:"土豆粉",price:5000},
  {id:6,name:"年糕",price:5000},
  {id:7,name:"白菜",price:2000},
  {id:8,name:"海带",price:2000},
  {id:9,name:"空心菜",price:3000},
  {id:10,name:"上海青",price:2000}
];
const cart={};

const menuList=document.getElementById("menuList");
const cartBtn=document.getElementById("cartBtn");
const cartPage=document.getElementById("cartPage");
const cartTableWrap=document.getElementById("cartTableWrap");
const checkoutBtn=document.getElementById("checkoutBtn");
const checkoutPage=document.getElementById("checkoutPage");
const checkoutList=document.getElementById("checkoutList");
const payPage=document.getElementById("payPage");
const payAmount=document.getElementById("payAmount");
const ussdBtn=document.getElementById("ussdBtn");

// 渲染菜单
function renderMenu(){
  menuList.innerHTML="";
  dishes.forEach(d=>{
    const div=document.createElement("div");
    div.className="dish";
    div.innerHTML=`<div><h4>${d.name}</h4><span>${d.price.toLocaleString()} UGX</span></div><button class="add-btn" data-id="${d.id}">加入</button>`;
    menuList.appendChild(div);
  });
}
renderMenu();

// 添加到购物车
function addToCart(id){
  if(!cart[id]) cart[id]=0;
  cart[id]++;
  updateCartBtn();
}
// 更新购物车按钮显示
function updateCartBtn(){
  const total=Object.entries(cart).reduce((s,[id,qty])=>s+qty*dishes[id].price,0);
  if(total>0){
    cartBtn.style.display="block";
    cartBtn.textContent=`${total.toLocaleString()} UGX →`;
  }else{
    cartBtn.style.display="none";
  }
}

// 渲染购物车表
function renderCartTable(){
  let html='<table><thead><tr><th>菜品</th><th>数量</th><th>金额</th></tr></thead><tbody>';
  let total=0;
  Object.entries(cart).forEach(([id,qty])=>{
    const p=dishes[id].price;
    total+=p*qty;
    html+=`<tr><td>${dishes[id].name}</td><td>${qty}</td><td>${(p*qty).toLocaleString()} UGX</td></tr>`;
  });
  html+='</tbody><tfoot><tr><td colspan="2">合计</td><td>'+total.toLocaleString()+' UGX</td></tr></tfoot></table>';
  cartTableWrap.innerHTML=html;
  checkoutBtn.disabled=total===0;
}

// 渲染结算列表
function renderCheckout(){
  let html='<ul style="list-style:none">';
  let total=0;
  Object.entries(cart).forEach(([id,qty])=>{
    const p=dishes[id].price;
    total+=p*qty;
    html+=`<li style="margin-bottom:6px;">${dishes[id].name} ×${qty} – ${(p*qty).toLocaleString()} UGX</li>`;
  });
  html+='</ul><p style="margin-top:8px;font-weight:600;">总计：'+total.toLocaleString()+' UGX</p>';
  checkoutList.innerHTML=html;
}

// 页面导航
const pages={home:document.getElementById("homePage"),menu:document.getElementById("menuPage"),cart:cartPage,checkout:checkoutPage,pay:payPage};
function show(tab){
  Object.values(pages).forEach(p=>p.classList.remove("active"));
  pages[tab].classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.toggle("active",b.dataset.tab===tab));
  if(tab==="cart")renderCartTable();
  if(tab==="checkout")renderCheckout();
}
// 底部导航事件
document.querySelectorAll("nav button").forEach(btn=>btn.onclick=()=>{
  const t=btn.dataset.tab;
  if(t==="checkout") return; // 我的未实现
  show(t);
});
// 动态按钮们
menuList.addEventListener("click",e=>{
  if(e.target.classList.contains("add-btn")){
    addToCart(e.target.dataset.id);
  }
});
cartBtn.onclick=()=>show("cart");
checkoutBtn.onclick=()=>show("checkout");

// 提交订单 → 支付指引
const submitOrderBtn=document.getElementById("submitOrderBtn");
submitOrderBtn.onclick=()=>{
  const total=Object.entries(cart).reduce((s,[id,qty])=>s+qty*dishes[id].price,0);
  payAmount.textContent=total.toLocaleString()+" UGX";
  ussdBtn.textContent=`*165*3*0771234567*${total}#`;
  navigator.clipboard.writeText(`*165*3*0771234567*${total}#`).catch(()=>{});
  show("pay");
};

// USSD 按钮
ussdBtn.onclick=()=>{
  window.location.href="tel:"+ussdBtn.textContent;
};

</script>
</body>
</html>
