<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>彭记饭店 · 点餐原型</title>
<style>
/* --- 样式同原来，略 --- */
</style>
</head>
<body>
<!-- ===== 1. 页面结构同原来 (省略) ===== -->

<script>
/* ---- 原来的菜品数据与函数 renderMenu/addToCart 等保持不变 ---- */

/* ★★ 关键改动 ① —— submitOrderBtn.onclick ★★ */
submitOrderBtn.onclick = ()=>{
  const total = Object.entries(cart)
              .reduce((s,[id,qty])=>s+qty*dishes[id].price,0);

  /* ▶ 生成订单对象 */
  const newOrder = {
     id      : Date.now(),                               // 简单用时间戳做订单号
     customer: document.getElementById('phoneInput').value,
     address : document.getElementById('addrInput').value,
     items   : Object.entries(cart).map(([id,qty])=>(
                 {name:dishes[id].name, qty:+qty})),
     total   : total,
     status  : "未处理"
  };

  /* ▶ 写入 localStorage（先取旧数组，再 push） */
  const all = JSON.parse(localStorage.getItem('orders')||'[]');
  all.push(newOrder);
  localStorage.setItem('orders', JSON.stringify(all));

  /* ---- 原有支付指引逻辑 ↓ ---- */
  payAmount.textContent = total.toLocaleString()+" UGX";
  ussdBtn.textContent   = `*165*3*0771234567*${total}#`;
  navigator.clipboard.writeText(ussdBtn.textContent).catch(()=>{});
  show("pay");
};
/* ---- 其余脚本保持不变 ---- */
</script>
</body>
</html>
